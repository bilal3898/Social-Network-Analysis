<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Social Network Analysis</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <script src="https://unpkg.com/cytoscape@3.24.0/dist/cytoscape.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    :root {
      --primary: #2563eb;
      --primary-dark: #1d4ed8;
      --dark-bg: #1e293b;
      --dark-text: #f1f5f9;
      --dark-card: #334155;
    }
    
    .dark {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --dark-bg: #0f172a;
      --dark-text: #e2e8f0;
      --dark-card: #1e293b;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f1f5f9;
      color: #334155;
      transition: background-color 0.3s, color 0.3s;
    }
    
    .profile-item {
    color: #1e293b; /* Dark text for light mode */
    transition: background-color 0.2s;
  }
  
  .dark .profile-item {
    color: #e2e8f0; /* Light text for dark mode */
  }
  
  .profile-item:hover {
    background-color: #f1f5f9;
  }
  
  .dark .profile-item:hover {
    background-color: #334155;
  }
  
  .profile-divider {
    background-color: #e2e8f0;
  }
  
  .dark .profile-divider {
    background-color: #334155;
  }

    .dark body {
      background-color: var(--dark-bg);
      color: var(--dark-text);
    }
    
    .dark .bg-white {
      background-color: var(--dark-card);
    }
    
    .dark .text-gray-700 {
      color: var(--dark-text);
    }
    
    .dark .border-gray-200 {
      border-color: #334155;
    }
    
    .dark .bg-gray-100 {
      background-color: #1e293b;
    }
    
    .dark .bg-gray-800 {
      background-color: #0f172a;
    }
    
    .dark .bg-blue-600 {
      background-color: var(--primary);
    }
    
    .tooltip {
      position: relative;
      display: inline-block;
    }
    
    .tooltip .tooltiptext {
      visibility: hidden;
      width: 200px;
      background-color: #1e293b;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -100px;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 14px;
      font-weight: normal;
    }
    
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .metric-card {
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .metric-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    .node-info {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 255, 255, 0.9);
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 100;
      max-width: 300px;
      display: none;
    }
    
    .dark .node-info {
      background: rgba(30, 41, 59, 0.9);
      color: #e2e8f0;
    }
    
    .graph-container {
      width: 100%;
      height: 500px;
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      background-color: #f8fafc;
    }
    
    .dark .graph-container {
      background-color: #1e293b;
      border-color: #334155;
    }
    
    .sidebar-btn.active {
      background-color: #3b82f6;
    }
    
    .tab-btn {
      border-bottom: 2px solid transparent;
      cursor: pointer;
    }
    
    .tab-btn.active {
      border-bottom: 2px solid #2563eb;
      color: #2563eb;
      font-weight: 600;
    }
    
    .dark .tab-btn.active {
      border-bottom: 2px solid var(--primary);
      color: var(--primary);
    }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }
    
    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 0.5rem;
      max-width: 500px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .dark .modal-content {
      background: var(--dark-card);
      color: var(--dark-text);
    }
    
    .use-case-card {
      border-radius: 0.5rem;
      background-color: white;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .dark .use-case-card {
      background-color: var(--dark-card);
    }
    
    .use-case-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    .use-case-header {
      padding: 1.5rem;
      color: white;
    }
    
    .use-case-body {
      padding: 1.5rem;
    }
    
    .use-case-title {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    .use-case-description {
      color: #4b5563;
      margin-bottom: 1rem;
    }
    
    .dark .use-case-description {
      color: #cbd5e1;
    }
    
    .use-case-preview {
      background-color: #f9fafb;
      border-radius: 0.375rem;
      padding: 1rem;
      margin-bottom: 1rem;
      font-family: monospace;
      font-size: 0.875rem;
      overflow-x: auto;
    }
    
    .dark .use-case-preview {
      background-color: #1e293b;
      color: #e2e8f0;
    }
    
    .use-case-list {
      list-style-type: disc;
      padding-left: 1.5rem;
      margin-top: 0.5rem;
      margin-bottom: 1rem;
    }
    
    .use-case-list li {
      margin-bottom: 0.25rem;
    }
    
    .profile-menu {
      display: none;
      position: absolute;
      right: 0;
      top: 100%;
      width: 240px;
      background: white;
      border-radius: 0.5rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      z-index: 50;
      overflow: hidden;
    }
    
    .dark .profile-menu {
      background: var(--dark-card);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
    }
    
    .profile-menu.active {
      display: block;
    }
    
    .profile-item {
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .profile-item:hover {
      background-color: #f1f5f9;
    }
    
    .dark .profile-item:hover {
      background-color: #334155;
    }
    
    .profile-icon {
      width: 24px;
      text-align: center;
      margin-right: 12px;
      font-size: 16px;
    }
    
    .profile-label {
      flex: 1;
    }
    
    .profile-divider {
      height: 1px;
      background-color: #e2e8f0;
      margin: 0.25rem 0;
    }
    
    .dark .profile-divider {
      background-color: #334155;
    }
    
    @media (max-width: 768px) {
      .sidebar {
        position: fixed;
        left: -100%;
        top: 0;
        bottom: 0;
        z-index: 100;
        transition: left 0.3s;
      }
      
      .sidebar.active {
        left: 0;
      }
      
      .sidebar-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(179, 170, 170, 0.5);
        z-index: 99;
      }
      
      .sidebar-overlay.active {
        display: block;
      }
      
      .mobile-menu-btn {
        display: block;
      }
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- Login Container -->
  <div id="loginContainer" class="min-h-screen flex items-center justify-center p-4 bg-gray-100">
    <div class="bg-white rounded-lg shadow-xl p-8 max-w-md w-full">
      <h2 class="text-2xl font-bold text-center mb-6">Social Network Analysis Login</h2>
      <form id="loginForm">
        <div class="mb-4">
          <label for="username" class="block text-gray-700 text-sm font-bold mb-2">Email</label>
          <input type="email" id="loginEmail" placeholder="Enter your email" class="border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
        </div>
        <div class="mb-6">
          <label for="password" class="block text-gray-700 text-sm font-bold mb-2">Password</label>
          <input type="password" id="loginPassword" placeholder="Enter your password" class="border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline">
          <a href="#" id="forgotPasswordLink" class="text-blue-600 text-sm hover:underline">Forgot Password?</a>
        </div>
        <div class="flex items-center justify-between">
          <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full">
            Sign In
          </button>
        </div>
      </form>
      <div class="mt-4 text-center">
        <p class="text-gray-600 text-sm">Don't have an account? <a href="#" id="signupLink" class="text-blue-600 hover:underline">Sign up</a></p>
      </div>
    </div>
  </div>


  <!-- Signup Modal -->
<!-- Signup Modal -->
<div id="signupModal" class="modal hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50">
  <div class="modal-content bg-white p-6 rounded shadow-lg w-full max-w-md">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-bold">Create Account</h2>
      <button id="closeSignupModal" class="text-gray-500 hover:text-gray-700">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <form id="signupForm">
      <!-- New Fields Added -->
      <div class="mb-4">
        <label class="block mb-1">Full Name</label>
        <input type="text" id="signupName" class="w-full border rounded p-2" required />
      </div>
      <div class="mb-4">
        <label class="block mb-1">Username</label>
        <input type="text" id="signupUsername" class="w-full border rounded p-2" required />
      </div>
      <!-- Existing Fields -->
      <div class="mb-4">
        <label class="block mb-1">Email</label>
        <input type="email" id="signupEmail" class="w-full border rounded p-2" required />
      </div>
      <div class="mb-4">
        <label class="block mb-1">Password</label>
        <input type="password" id="signupPassword" class="w-full border rounded p-2" required />
      </div>
      <!-- New Fields -->
      <div class="mb-4">
        <label class="block mb-1">Mobile Number</label>
        <input type="tel" id="signupMobile" class="w-full border rounded p-2" required />
      </div>
      <div class="mb-4">
        <label class="block mb-1">Address</label>
        <textarea id="signupAddress" class="w-full border rounded p-2" required></textarea>
      </div>
      <div class="flex justify-end gap-3">
        <button type="button" id="cancelSignup" class="px-4 py-2 border rounded">Cancel</button>
        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded">Sign Up</button>
      </div>
    </form>
  </div>
</div>

  <!-- Forgot Password Modal -->
  <div id="forgotPasswordModal" class="modal">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold">Reset Password</h2>
        <button id="closeForgotPasswordModal" class="text-gray-500 hover:text-gray-700">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="space-y-4">
        <div>
          <label class="block mb-2">Email Address</label>
          <input type="email" id="forgotPasswordEmail" class="w-full border rounded p-2" placeholder="your@email.com">
        </div>
        <div class="flex justify-end gap-3">
          <button id="cancelForgotPassword" class="px-4 py-2 border border-gray-300 rounded">Cancel</button>
          <button id="submitForgotPassword" class="px-4 py-2 bg-blue-600 text-white rounded">Reset Password</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Header -->
  <header class="bg-blue-600 text-white p-4 shadow-md flex justify-between items-center">
    <div class="flex items-center">
      <button id="sidebarToggle" class="mr-3 text-white">
        <i class="fas fa-bars text-xl"></i>
      </button>
      <div class="text-xl font-bold flex items-center gap-2">
        <i class="fas fa-network-wired"></i> Social Network Analysis
      </div>
    </div>
    
    <div class="flex items-center gap-3">
      <button id="themeToggle" class="tooltip bg-white text-blue-600 px-3 py-1 rounded hover:bg-gray-100">
        <i class="fas fa-moon"></i>
        <span class="tooltiptext">Toggle Dark Mode</span>
      </button>
      
      <div class="relative">
        <button id="profileBtn" class="flex items-center text-sm text-white rounded-full hover:opacity-80 focus:outline-none">
          <img class="w-8 h-8 rounded-full" src="https://ui-avatars.com/api/?name=User&background=random" alt="User">
        </button>
        <div id="profileMenu" class="profile-menu">
    <div id="profileMenuItemProfile" class="profile-item">
      <div class="profile-icon"><i class="fas fa-user"></i></div>
      <div class="profile-label">My Profile</div>
    </div>
    <div id="profileMenuItemSettings" class="profile-item">
      <div class="profile-icon"><i class="fas fa-cog"></i></div>
      <div class="profile-label">Settings</div>
    </div>
    <div id="profileMenuItemHistory" class="profile-item">
      <div class="profile-icon"><i class="fas fa-history"></i></div>
      <div class="profile-label">My History</div>
    </div>
    <div id="profileMenuItemFeedback" class="profile-item">
      <div class="profile-icon"><i class="fas fa-comment"></i></div>
      <div class="profile-label">Feedback</div>
    </div>
    <div class="profile-divider"></div>
    <div class="profile-item" id="darkModeMenuItem">
      <div class="profile-icon"><i class="fas fa-moon"></i></div>
      <div class="profile-label">Dark Mode</div>
      <div class="toggle-switch">
        <input type="checkbox" id="darkModeToggle" class="hidden">
        <label for="darkModeToggle" class="flex items-center cursor-pointer">
          <div class="relative">
            <div class="w-10 h-6 bg-gray-300 rounded-full shadow-inner"></div>
            <div class="absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition transform"></div>
          </div>
        </label>
      </div>
    </div>
    <div class="profile-divider"></div>
    <div id="profileMenuItemHelp" class="profile-item">
      <div class="profile-icon"><i class="fas fa-question-circle"></i></div>
      <div class="profile-label">Help & Support</div>
    </div>
    <div id="profileMenuItemSignOut" class="profile-item">
      <div class="profile-icon"><i class="fas fa-sign-out-alt"></i></div>
      <div class="profile-label">Sign Out</div>
    </div>
  </div>
  </header>

  <!-- Settings Modal -->
  <div id="settingsModal" class="hidden fixed inset-0 z-50 bg-black bg-opacity-40 flex justify-center items-center">
    <div class="modal-content">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-xl font-bold">Settings</h2>
        <button id="closeSettings" class="text-gray-500 hover:text-gray-700">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="space-y-4">
        <div>
          <h3 class="font-medium mb-2">Graph Visualization</h3>
          <div class="space-y-2">
            <div class="flex items-center">
              <input type="checkbox" id="nodeLabels" class="mr-2" checked>
              <label for="nodeLabels">Show node labels</label>
            </div>
            <div class="flex items-center">
              <input type="checkbox" id="edgeArrows" class="mr-2" checked>
              <label for="edgeArrows">Show edge arrows</label>
            </div>
            <div class="flex items-center">
              <input type="checkbox" id="communityColors" class="mr-2" checked>
              <label for="communityColors">Color by community</label>
            </div>
          </div>
        </div>
        
        <div>
          <h3 class="font-medium mb-2">Analysis Preferences</h3>
          <div class="space-y-2">
            <div class="flex items-center">
              <input type="checkbox" id="autoPredict" class="mr-2" checked>
              <label for="autoPredict">Auto-run link prediction</label>
            </div>
            <div class="flex items-center">
              <input type="checkbox" id="highlightCentral" class="mr-2">
              <label for="highlightCentral">Highlight central nodes</label>
            </div>
          </div>
        </div>
        
        <div>
          <h3 class="font-medium mb-2">Data Display</h3>
          <div class="space-y-2">
            <div>
              <label class="block mb-1">Default tab:</label>
              <select class="w-full border rounded p-2">
                <option>Overview</option>
                <option>Metrics</option>
                <option>Communities</option>
                <option>Predictions</option>
              </select>
            </div>
            <div>
              <label class="block mb-1">Decimal precision:</label>
              <input type="number" min="1" max="5" value="3" class="w-full border rounded p-2">
            </div>
          </div>
        </div>
        
        <div class="flex justify-end gap-3 mt-6">
          <button id="cancelSettings" class="px-4 py-2 border border-gray-300 rounded">Cancel</button>
          <button id="saveSettings" class="px-4 py-2 bg-blue-600 text-white rounded">Save Settings</button>
        </div>
      </div>
    </div>
  </div>

  <div id="feedbackModal" class="modal">
  <div class="modal-content">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-bold">Send Feedback</h2>
      <button id="closeFeedback" class="text-gray-500 hover:text-gray-700">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="space-y-4">
      <div>
        <label class="block mb-2">Your Feedback</label>
        <textarea id="feedbackText" rows="4" class="w-full border rounded p-2" placeholder="What do you think about our tool?"></textarea>
      </div>
      <div class="flex justify-end gap-3">
        <button id="cancelFeedback" class="px-4 py-2 border border-gray-300 rounded">Cancel</button>
        <button id="submitFeedback" class="px-4 py-2 bg-blue-600 text-white rounded">Submit Feedback</button>
      </div>
    </div>
  </div>
</div>

<!-- Add this signout modal before the closing </body> tag -->
<div id="signoutModal" class="modal">
  <div class="modal-content">
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-bold">Sign Out</h2>
      <button id="closeSignout" class="text-gray-500 hover:text-gray-700">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <p class="mb-6">Are you sure you want to sign out?</p>
    <div class="flex justify-end gap-3">
      <button id="cancelSignout" class="px-4 py-2 border border-gray-300 rounded">Cancel</button>
      <button id="confirmSignout" class="px-4 py-2 bg-red-600 text-white rounded">Sign Out</button>
    </div>
  </div>
</div>

  <!-- Sidebar Overlay for Mobile -->
  <div class="sidebar-overlay"></div>

  <!-- Main Section -->
  <main class="flex flex-1">
    <!-- Sidebar -->
    <aside class="sidebar w-56 bg-gray-800 text-white p-4 md:block">
      <nav class="space-y-2">
        <button class="sidebar-btn active w-full flex items-center gap-2 p-3 rounded hover:bg-blue-600" data-tab="overviewTab">
          <i class="fas fa-chart-pie"></i> Overview
        </button>
        <button class="sidebar-btn w-full flex items-center gap-2 p-3 rounded hover:bg-blue-600" data-tab="communitiesTab">
          <i class="fas fa-layer-group"></i> Community Detection
        </button>
        <button class="sidebar-btn w-full flex items-center gap-2 p-3 rounded hover:bg-blue-600" data-tab="predictionsTab">
          <i class="fas fa-project-diagram"></i> Link Prediction
        </button>
        <button class="sidebar-btn w-full flex items-center gap-2 p-3 rounded hover:bg-blue-600" data-tab="metricsTab">
          <i class="fas fa-chart-line"></i> Network Metrics
        </button>
        <button class="sidebar-btn w-full flex items-center gap-2 p-3 rounded hover:bg-blue-600" data-tab="nodeAnalysisTab">
          <i class="fas fa-user-friends"></i> Node Analysis
        </button>
        <button class="sidebar-btn w-full flex items-center gap-2 p-3 rounded hover:bg-blue-600" data-tab="historicalDataTab">
          <i class="fas fa-history"></i> Historical Data
        </button>
        <button class="sidebar-btn w-full flex items-center gap-2 p-3 rounded hover:bg-blue-600" data-tab="useCasesTab">
        <i class="fas fa-lightbulb"></i> Use Cases
      </button>
      </nav>
      
      <div class="mt-8 pt-4 border-t border-gray-700">
        <h3 class="font-semibold mb-2">Network Info</h3>
        <div class="text-sm space-y-1">
          <div class="flex justify-between">
            <span>Nodes:</span>
            <span id="nodeCount">0</span>
          </div>
          <div class="flex justify-between">
            <span>Edges:</span>
            <span id="edgeCount">0</span>
          </div>
          <div class="flex justify-between">
            <span>Communities:</span>
            <span id="communityCount">0</span>
          </div>
          <div class="flex justify-between">
            <span>Density:</span>
            <span id="density">0.00</span>
          </div>
        </div>
      </div>
    </aside>

    <!-- Content -->
    <section class="flex-1 p-6 overflow-auto">
      <!-- Upload Form -->
      <form id="uploadForm" class="mb-6 flex flex-col md:flex-row gap-4 items-start md:items-center" enctype="multipart/form-data">
        <div class="flex-1 flex flex-col sm:flex-row gap-3">
          <div class="relative flex-1">
            <input type="file" id="fileInput" name="file" accept=".csv, .json" class="border p-2 rounded bg-white shadow w-full"/>
            <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
              <i class="fas fa-file-csv text-blue-500"></i>
            </div>
          </div>
          <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2">
            <i class="fas fa-cloud-upload-alt"></i> Upload & Analyze
          </button>
        </div>
        <div class="flex items-center gap-3">
          <button type="button" id="sampleDataBtn" class="text-blue-600 hover:text-blue-800 flex items-center gap-1">
            <i class="fas fa-vial"></i> Load Sample Data
          </button>
        </div>
      </form>
      
      <!-- Status Messages -->
      <div id="statusArea" class="mb-4">
        <div id="statusMsg" class="text-sm text-gray-600"></div>
        <div id="errorMsg" class="text-sm text-red-500 hidden"></div>
        <div id="loadingSpinner" class="hidden flex items-center mt-2">
          <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500 mr-2"></div>
          <span>Analyzing network data...</span>
        </div>
      </div>

      <!-- Search Node -->
      <div class="mb-4 flex gap-3">
        <div class="relative flex-1">
          <input type="text" id="searchNode" placeholder="Search for a node..." class="border p-2 rounded w-full pl-10">
          <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <i class="fas fa-search text-gray-400"></i>
          </div>
        </div>
        <button id="predictLinksBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded hidden">
          <i class="fas fa-magic mr-2"></i> Predict Links
        </button>
      </div>

      <!-- Node Info Panel -->
      <div id="nodeInfo" class="node-info">
        <h3 class="font-bold mb-2 border-b pb-1">Node Details</h3>
        <div id="nodeDetails"></div>
      </div>

      <!-- Graph Container -->
      <div id="graph" class="graph-container relative mb-6"></div>

      <!-- Tab Navigation -->
      <div class="flex border-b border-gray-300 mb-6">
        <button class="tab-btn py-2 px-4 border-b-2 border-blue-500 text-blue-600 font-medium active" data-tab="overviewTab">Overview</button>
        <button class="tab-btn py-2 px-4 text-gray-600 hover:text-blue-600" data-tab="metricsTab">Metrics</button>
        <button class="tab-btn py-2 px-4 text-gray-600 hover:text-blue-600" data-tab="communitiesTab">Communities</button>
        <button class="tab-btn py-2 px-4 text-gray-600 hover:text-blue-600" data-tab="predictionsTab">Predictions</button>
        <button class="tab-btn py-2 px-4 text-gray-600 hover:text-blue-600" data-tab="exportTab">Export</button>
        <button class="tab-btn py-2 px-4 text-gray-600 hover:text-blue-600" data-tab="useCasesTab">Use Cases</button>
      </div>

      <!-- Tab Content -->
      <div class="tab-content active" id="overviewTab">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
          <div class="metric-card bg-white rounded-lg shadow p-5 flex flex-col items-center">
            <div class="w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center mb-3">
              <i class="fas fa-users text-blue-600 text-2xl"></i>
            </div>
            <h3 class="font-bold text-lg">Network Density</h3>
            <p class="text-3xl font-light my-2" id="densityMetric">0.00</p>
            <p class="text-sm text-gray-500">Higher density indicates more connections</p>
          </div>
          
          <div class="metric-card bg-white rounded-lg shadow p-5 flex flex-col items-center">
            <div class="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mb-3">
              <i class="fas fa-project-diagram text-green-600 text-2xl"></i>
            </div>
            <h3 class="font-bold text-lg">Avg. Path Length</h3>
            <p class="text-3xl font-light my-2" id="pathLengthMetric">0.00</p>
            <p class="text-sm text-gray-500">Average degrees of separation</p>
          </div>
          
          <div class="metric-card bg-white rounded-lg shadow p-5 flex flex-col items-center">
            <div class="w-16 h-16 rounded-full bg-purple-100 flex items-center justify-center mb-3">
              <i class="fas fa-object-group text-purple-600 text-2xl"></i>
            </div>
            <h3 class="font-bold text-lg">Modularity</h3>
            <p class="text-3xl font-light my-2" id="modularityMetric">0.00</p>
            <p class="text-sm text-gray-500">Measure of community structure strength</p>
          </div>
        </div>
        
        <div class="bg-white rounded-lg shadow p-5 mb-6">
          <h2 class="text-xl font-bold mb-4">Centrality Distribution</h2>
          <div class="h-64">
            <canvas id="centralityChart"></canvas>
          </div>
        </div>
      </div>
      
      <div class="tab-content" id="metricsTab">
        <div class="bg-white rounded-lg shadow p-5 mb-6">
          <h2 class="text-xl font-bold mb-4">Key Network Metrics</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            <div class="border rounded-lg p-4">
              <h3 class="font-bold mb-2">Global Metrics</h3>
              <div class="space-y-2">
                <div class="flex justify-between">
                  <span>Number of Nodes:</span>
                  <span class="font-mono" id="globalNodes">0</span>
                </div>
                <div class="flex justify-between">
                  <span>Number of Edges:</span>
                  <span class="font-mono" id="globalEdges">0</span>
                </div>
                <div class="flex justify-between">
                  <span>Average Degree:</span>
                  <span class="font-mono" id="avgDegree">0.00</span>
                </div>
                <div class="flex justify-between">
                  <span>Diameter:</span>
                  <span class="font-mono" id="diameter">0</span>
                </div>
              </div>
            </div>
            <div class="border rounded-lg p-4">
              <h3 class="font-bold mb-2">Centrality Measures</h3>
              <div class="space-y-2">
                <div class="flex justify-between">
                  <span>Most Central Node:</span>
                  <span class="font-mono" id="centralNode">-</span>
                </div>
                <div class="flex justify-between">
                  <span>Highest Betweenness:</span>
                  <span class="font-mono" id="betweennessNode">-</span>
                </div>
                <div class="flex justify-between">
                  <span>Highest Closeness:</span>
                  <span class="font-mono" id="closenessNode">-</span>
                </div>
              </div>
            </div>
          </div>
          
          <h3 class="font-bold mb-2">Top Nodes by Centrality</h3>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Node</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Degree</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Betweenness</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Closeness</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Eigenvector</th>
                </tr>
              </thead>
              <tbody id="topNodesTable" class="bg-white divide-y divide-gray-200">
                <tr><td colspan="5" class="text-center py-4">No data available</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <div class="tab-content" id="communitiesTab">
        <div class="bg-white rounded-lg shadow p-5 mb-6">
          <h2 class="text-xl font-bold mb-4">Detected Communities</h2>
          <div id="communitiesList" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="text-center py-8 text-gray-500">
              <i class="fas fa-layer-group text-4xl mb-3"></i>
              <p>No community data available</p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="tab-content" id="predictionsTab">
        <div class="bg-white rounded-lg shadow p-5 mb-6">
          <h2 class="text-xl font-bold mb-4">Top Link Predictions</h2>
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Source</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Target</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Probability</th>
              </tr>
            </thead>
            <tbody id="predictionTable" class="bg-white divide-y divide-gray-200">
              <tr><td colspan="3" class="text-center py-4">No predictions available</td></tr>
            </tbody>
          </table>
        </div>
      </div>
      
      <div class="tab-content" id="nodeAnalysisTab">
        <div class="bg-white rounded-lg shadow p-5 mb-6">
          <h2 class="text-xl font-bold mb-4">Node Analysis</h2>
          <div class="mb-4">
            <label class="block mb-2">Select Node:</label>
            <select id="nodeSelector" class="w-full md:w-1/3 border rounded p-2">
              <option value="">Select a node</option>
            </select>
          </div>
          <div id="nodeAnalysisResults" class="border rounded-lg p-4">
            <div class="text-center py-8 text-gray-500">
              <i class="fas fa-user-friends text-4xl mb-3"></i>
              <p>Select a node to view its analysis</p>
            </div>
          </div>
        </div>
      </div>
      
     <div class="tab-content" id="historicalDataTab">
  <h2 class="text-xl font-bold mb-4">Historical Analysis</h2>
  <div class="mb-4 flex gap-3">
    <div class="flex-1">
      <label class="block mb-2">Date Range:</label>
      <select id="dateRange" class="w-full border rounded p-2">
        <option>Last 7 days</option>
        <option>Last 30 days</option>
        <option>Last 90 days</option>
        <option>All time</option>
      </select>
    </div>
    <div class="flex-1">
      <label class="block mb-2">Analysis Type:</label>
      <select id="analysisType" class="w-full border rounded p-2">
        <option>Network Growth</option>
        <option>Community Evolution</option>
        <option>Centrality Trends</option>
      </select>
    </div>
  </div>

  <!-- üî• THIS IS YOUR DYNAMIC AREA -->
  <div class="space-y-4" id="historyList"></div>
</div>
      
      <div class="tab-content" id="exportTab">
        <div class="bg-white rounded-lg shadow p-5 mb-6">
          <h2 class="text-xl font-bold mb-4">Export Analysis Results</h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <button id="exportCSV" class="export-btn flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition">
              <i class="fas fa-file-csv text-3xl text-blue-500 mb-3"></i>
              <span class="font-semibold">CSV Data</span>
              <span class="text-sm text-gray-500">Export metrics as CSV</span>
            </button>
            <button id="exportPNG" class="export-btn flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-green-500 hover:bg-green-50 transition">
              <i class="fas fa-file-image text-3xl text-green-500 mb-3"></i>
              <span class="font-semibold">Graph Image</span>
              <span class="text-sm text-gray-500">PNG or SVG format</span>
            </button>
            <button id="exportPDF" class="export-btn flex flex-col items-center justify-center p-6 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition">
              <i class="fas fa-file-pdf text-3xl text-purple-500 mb-3"></i>
              <span class="font-semibold">PDF Report</span>
              <span class="text-sm text-gray-500">Comprehensive analysis</span>
            </button>
          </div>
        </div>
      </div>

      <div class="tab-content" id="useCasesTab">
        <div class="bg-white rounded-lg shadow p-5 mb-6"></div>
      <h2 class="text-2xl font-bold mb-6">Practical Applications of Social Network Analysis</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Health/Epidemiology Card -->
        <div class="use-case-card">
          <div class="use-case-header bg-green-600">
            <h3 class="text-xl font-bold">Health/Epidemiology</h3>
          </div>
          <div class="use-case-body">
            <h4 class="use-case-title">Trace infection spread, identify superspreaders</h4>
            <p class="use-case-description">Analyze contact networks to understand disease transmission patterns.</p>
            
            <div class="use-case-preview">
              Patient_A,Patient_B<br>
              John,Mary<br>
              Mary,Ali<br>
              Ali,Sameer<br>
              John,Sameer
            </div>
            
            <ul class="use-case-list">
              <li>ü¶† Identify superspreaders (high degree centrality)</li>
              <li>üîÑ Predict spread paths (link prediction)</li>
              <li>üß™ Simulate impact of removing nodes (containment)</li>
            </ul>
            
            <button onclick="loadSample('health')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center gap-2">
              <i class="fas fa-vial"></i> Try Health Sample
            </button>
          </div>
        </div>
        
        <!-- HR / Team Communication Card -->
        <div class="use-case-card">
          <div class="use-case-header bg-indigo-600">
            <h3 class="text-xl font-bold">HR / Team Communication</h3>
          </div>
          <div class="use-case-body">
            <h4 class="use-case-title">Visualize internal communication, identify silos or team leads</h4>
            <p class="use-case-description">Analyze collaboration networks to improve team efficiency.</p>
            
            <div class="use-case-preview">
              Employee_A,Employee_B<br>
              Alice,Bob<br>
              Alice,David<br>
              Bob,Eve<br>
              Eve,Charlie
            </div>
            
            <ul class="use-case-list">
              <li>üí° Identify team influencers, central decision makers</li>
              <li>üìà Analyze communication patterns</li>
              <li>üß© Detect silos or disconnected departments</li>
            </ul>
            
            <button onclick="loadSample('hr')" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded flex items-center gap-2">
              <i class="fas fa-vial"></i> Try HR Sample
            </button>
          </div>
        </div>
        
        <!-- Cybersecurity Card -->
        <div class="use-case-card">
          <div class="use-case-header bg-red-600">
            <h3 class="text-xl font-bold">Cybersecurity</h3>
          </div>
          <div class="use-case-body">
            <h4 class="use-case-title">Visualize IP-to-IP interactions to spot threats</h4>
            <p class="use-case-description">Analyze network connections to identify malicious activities.</p>
            
            <div class="use-case-preview">
              Source_IP,Target_IP<br>
              192.168.0.1,192.168.0.2<br>
              192.168.0.2,10.0.0.5<br>
              10.0.0.5,10.0.0.9<br>
              192.168.0.1,10.0.0.9
            </div>
            
            <ul class="use-case-list">
              <li>üß† Identify central malicious nodes</li>
              <li>üîç Detect anomaly patterns</li>
              <li>üì° Community-based intrusion tracking</li>
            </ul>
            
            <button onclick="loadSample('cybersecurity')" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded flex items-center gap-2">
              <i class="fas fa-vial"></i> Try Cybersecurity Sample
            </button>
          </div>
        </div>
        
        <!-- Social Media Card -->
        <div class="use-case-card">
          <div class="use-case-header bg-blue-600">
            <h3 class="text-xl font-bold">Social Media</h3>
          </div>
          <div class="use-case-body">
            <h4 class="use-case-title">Map connections to find influencers</h4>
            <p class="use-case-description">Analyze social networks to identify key influencers and communities.</p>
            
            <div class="use-case-preview">
              User_A,User_B<br>
              @elonmusk,@tesla<br>
              @tesla,@spacex<br>
              @spacex,@nasa<br>
              @nasa,@isro
            </div>
            
            <ul class="use-case-list">
              <li>üîç Influencer identification (via centrality)</li>
              <li>üï∏Ô∏è Community detection (interest groups)</li>
              <li>üîó Predict future connections</li>
            </ul>
            
            <button onclick="loadSample('social')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2">
              <i class="fas fa-vial"></i> Try Social Media Sample
            </button>
          </div>
        </div>
        
        <!-- Academic Research Card -->
        <div class="use-case-card">
          <div class="use-case-header bg-purple-600">
            <h3 class="text-xl font-bold">Academic Research</h3>
          </div>
          <div class="use-case-body">
            <h4 class="use-case-title">Analyze citation networks and collaborations</h4>
            <p class="use-case-description">Map research relationships to identify key papers and authors.</p>
            
            <div class="use-case-preview">
              Paper_A,Paper_B<br>
              "Network Science","Graph Theory"<br>
              "Graph Theory","Complex Systems"<br>
              "Complex Systems","Network Science"<br>
              "AI Research","Network Science"
            </div>
            
            <ul class="use-case-list">
              <li>üèÜ Identify seminal papers (central nodes)</li>
              <li>üìö Map research fields (communities)</li>
              <li>üîÆ Predict potential collaborations</li>
            </ul>
            
            <button onclick="loadSample('academic')" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded flex items-center gap-2">
              <i class="fas fa-vial"></i> Try Academic Sample
            </button>
          </div>
        </div>
        
        <!-- E-Commerce Card -->
        <div class="use-case-card">
          <div class="use-case-header bg-yellow-600">
            <h3 class="text-xl font-bold">E-Commerce</h3>
          </div>
          <div class="use-case-body">
            <h4 class="use-case-title">Enhance recommendation systems</h4>
            <p class="use-case-description">Analyze customer-product relationships to improve recommendations.</p>
            
            <div class="use-case-preview">
              Customer,Product<br>
              User123,ProductA<br>
              User123,ProductB<br>
              User456,ProductA<br>
              User456,ProductC
            </div>
            
            <ul class="use-case-list">
              <li>üîó Suggest products (link prediction)</li>
              <li>üéØ Segment customers (community detection)</li>
              <li>üìà Identify popular product clusters</li>
            </ul>
            
            <button onclick="loadSample('ecommerce')" class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded flex items-center gap-2">
              <i class="fas fa-vial"></i> Try E-Commerce Sample
            </button>
          </div>
        </div>
      </div>
    </div>

          
          <div class="border rounded-lg p-4 mb-4">
            <h3 class="font-bold mb-3">Custom Export</h3>
            <div class="flex flex-col sm:flex-row gap-4">
              <div class="flex-1">
                <label class="block text-sm font-medium text-gray-700 mb-1">Data Format</label>
                <select id="exportFormat" class="w-full border rounded p-2">
                  <option>CSV</option>
                  <option>JSON</option>
                  <option>Excel</option>
                </select>
              </div>
              <div class="flex-1">
                <label class="block text-sm font-medium text-gray-700 mb-1">Content</label>
                <select id="exportContent" class="w-full border rounded p-2">
                  <option>All Metrics</option>
                  <option>Centrality Scores</option>
                  <option>Community Data</option>
                  <option>Link Predictions</option>
                </select>
              </div>
              <div class="flex items-end">
                <button id="customExport" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
                  <i class="fas fa-download mr-2"></i> Export
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white text-center p-3 text-sm">
    &copy; 2025 Social Network Analysis Tool | <span id="version">v2.4.1</span> | 
    <a href="#" class="hover:text-blue-300">Documentation</a> | 
    <a href="#" class="hover:text-blue-300">Support</a>
  </footer>

  <script>
    // Global variables
    let cy;
    let currentAnalysis = null;
    let centralityChart = null;
    const colorMap = ["#3498db", "#e74c3c", "#2ecc71", "#f39c12", "#9b59b6"];
    
    // Initialize UI components
    document.addEventListener('DOMContentLoaded', function() {
      renderHistoryList();
      
      // Toggle sidebar
      // Add this to the existing script
document.addEventListener('DOMContentLoaded', function() {
  // Toggle sidebar on mobile
  const sidebarToggle = document.getElementById('sidebarToggle');
  const sidebar = document.querySelector('.sidebar');
  const sidebarOverlay = document.querySelector('.sidebar-overlay');
  
  sidebarToggle.addEventListener('click', () => {
    sidebar.classList.toggle('active');
    sidebarOverlay.classList.toggle('active');
  });
  
  if (sidebarOverlay) {
    sidebarOverlay.addEventListener('click', () => {
      sidebar.classList.remove('active');
      sidebarOverlay.classList.remove('active');
    });
  }
});
      
      // Profile menu toggle
      const profileBtn = document.getElementById('profileBtn');
      const profileMenu = document.getElementById('profileMenu');
      
      profileBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        profileMenu.classList.toggle('active');
      });
      
      // Close profile menu when clicking elsewhere
      document.addEventListener('click', (e) => {
        if (!profileMenu.contains(e.target) && e.target !== profileBtn) {
          profileMenu.classList.remove('active');
        }
      });
      
      // Dark mode toggle
      const themeToggle = document.getElementById('themeToggle');
      const darkModeToggle = document.getElementById('darkModeToggle');
      
      themeToggle.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
      });
      
      darkModeToggle.addEventListener('change', () => {
        document.documentElement.classList.toggle('dark');
        localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
      });
      
      // Check for saved dark mode preference
      if (localStorage.getItem('darkMode') === 'true') {
        document.documentElement.classList.add('dark');
        darkModeToggle.checked = true;
      }

      // Profile menu functionality
  document.getElementById('profileMenuItemProfile').addEventListener('click', function() {
    showNotification('Profile page is under development', 'info');
    profileMenu.classList.remove('active');
  });
  
  document.getElementById('profileMenuItemSettings').addEventListener('click', function() {
    settingsModal.style.display = 'flex';
    profileMenu.classList.remove('active');
  });
  
  document.getElementById('profileMenuItemHistory').addEventListener('click', function() {
    document.querySelector('.sidebar-btn[data-tab="historicalDataTab"]').click();
    profileMenu.classList.remove('active');
    renderHistoryList();
  });
  
  document.getElementById('profileMenuItemFeedback').addEventListener('click', function() {
    document.getElementById('feedbackModal').style.display = 'flex';
    profileMenu.classList.remove('active');
  });
  
  document.getElementById('profileMenuItemHelp').addEventListener('click', function() {
    showNotification('Help documentation will open in new window', 'info');
    profileMenu.classList.remove('active');
  });
  
  document.getElementById('profileMenuItemSignOut').addEventListener('click', function() {
    document.getElementById('signoutModal').style.display = 'flex';
    profileMenu.classList.remove('active');
  });

  // Feedback modal functionality
  document.getElementById('closeFeedback').addEventListener('click', function() {
    document.getElementById('feedbackModal').style.display = 'none';
  });
  
  document.getElementById('cancelFeedback').addEventListener('click', function() {
    document.getElementById('feedbackModal').style.display = 'none';
  });
  
  document.getElementById('submitFeedback').addEventListener('click', function() {
    const feedback = document.getElementById('feedbackText').value;
    if (feedback.trim()) {
      showNotification('Thanks for your feedback!', 'success');
      document.getElementById('feedbackModal').style.display = 'none';
    } else {
      showNotification('Please enter your feedback', 'error');
    }
  });

  // Signout modal functionality
  document.getElementById('closeSignout').addEventListener('click', function() {
    document.getElementById('signoutModal').style.display = 'none';
  });
  
  document.getElementById('cancelSignout').addEventListener('click', function() {
    document.getElementById('signoutModal').style.display = 'none';
  });
  
  document.getElementById('confirmSignout').addEventListener('click', function() {
    showNotification('You have been signed out', 'success');
    document.getElementById('signoutModal').style.display = 'none';
    // Add actual signout logic here
  });

  // Logout functionality
    document.getElementById('confirmSignout').addEventListener('click', function() {
      // Clear login state
      localStorage.removeItem('isLoggedIn');
      
      // Simulate logout request
      fetch('/logout', { method: 'POST' })
        .then(() => {
          showNotification('You have been signed out', 'success');
          document.getElementById('signoutModal').style.display = 'none';
          appContainer.classList.add('hidden');
          loginContainer.classList.remove('hidden');
        });
    });

  // Login functionality
    const loginContainer = document.getElementById('loginContainer');
    const appContainer = document.getElementById('appContainer');
    const loginForm = document.getElementById('loginForm');
    
    // Check if user is already logged in
    if (localStorage.getItem('isLoggedIn') === 'true') {
      loginContainer.classList.add('hidden');
      appContainer.classList.remove('hidden');
    }
    
    loginForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      
      // Simple validation
      if (!email || !password) {
        showNotification('Please fill in all fields', 'error');
        return;
      }
      
      // Simulate login request
      fetch('/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          localStorage.setItem('isLoggedIn', 'true');
          loginContainer.classList.add('hidden');
          appContainer.classList.remove('hidden');
          showNotification('Login successful!', 'success');
        } else {
          showNotification(data.error || 'Login failed', 'error');
        }
      })
      .catch(error => {
        showNotification('Network error', 'error');
      });
    });

    // Show signup modal
document.getElementById('signupLink').addEventListener('click', function(e) {
  e.preventDefault();
  document.getElementById('signupModal').classList.remove('hidden');
});

// Close signup modal
document.getElementById('closeSignupModal').addEventListener('click', function() {
  document.getElementById('signupModal').classList.add('hidden');
});

document.getElementById('cancelSignup').addEventListener('click', function() {
  document.getElementById('signupModal').classList.add('hidden');
});

// Signup form submission
// Signup form submission
document.getElementById('signupForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  // Collect all form data
  const name = document.getElementById('signupName').value;
  const username = document.getElementById('signupUsername').value;
  const email = document.getElementById('signupEmail').value;
  const password = document.getElementById('signupPassword').value;
  const mobile = document.getElementById('signupMobile').value;
  const address = document.getElementById('signupAddress').value;

  // Validation
  if (!name || !username || !email || !password || !mobile || !address) {
    showNotification('Please fill in all fields', 'error');
    return;
  }

  // Mobile number validation
  const mobileRegex = /^[0-9]{10}$/;
  if (!mobileRegex.test(mobile)) {
    showNotification('Please enter a valid 10-digit mobile number', 'error');
    return;
  }

  // Send data to server
  fetch('/signup', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ 
      name, 
      username, 
      email, 
      password, 
      mobile, 
      address 
    })
  })
  .then(res => res.json())
  .then(data => {
    if (data.success) {
      showNotification('Signup successful! Please login.', 'success');
      document.getElementById('signupModal').classList.add('hidden');
      // Reset form
      document.getElementById('signupForm').reset();
    } else {
      showNotification(data.error || 'Signup failed', 'error');
    }
  })
  .catch(() => showNotification('Network error', 'error'));
});

    
    // Forgot password functionality
    document.getElementById('forgotPasswordLink').addEventListener('click', function(e) {
      e.preventDefault();
      document.getElementById('forgotPasswordModal').style.display = 'flex';
    });
    
    document.getElementById('closeForgotPasswordModal').addEventListener('click', function() {
      document.getElementById('forgotPasswordModal').style.display = 'none';
    });
    
    document.getElementById('cancelForgotPassword').addEventListener('click', function() {
      document.getElementById('forgotPasswordModal').style.display = 'none';
    });
    
    document.getElementById('submitForgotPassword').addEventListener('click', function() {
      const email = document.getElementById('forgotPasswordEmail').value;
      if (!email) {
        showNotification('Please enter your email', 'error');
        return;
      }
      
      // Simulate password reset request
      fetch('/forgot-password', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email })
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          showNotification('Password reset instructions sent to your email', 'success');
          document.getElementById('forgotPasswordModal').style.display = 'none';
        } else {
          showNotification(data.error || 'Password reset failed', 'error');
        }
      });
    });
      
      // Tab functionality
      const tabBtns = document.querySelectorAll('.tab-btn');
      
      tabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          // Remove active class from all tabs
          tabBtns.forEach(b => b.classList.remove('border-blue-500', 'text-blue-600', 'active'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          
          // Add active class to clicked tab
          btn.classList.add('border-blue-500', 'text-blue-600', 'active');
          
          // Show corresponding content
          const tabId = btn.getAttribute('data-tab');
          document.getElementById(tabId).classList.add('active');
        });
      });
      
      // Sidebar button functionality
      const sidebarBtns = document.querySelectorAll('.sidebar-btn');
      sidebarBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          sidebarBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          
          // Switch to the corresponding tab
          const tabId = btn.getAttribute('data-tab');
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          document.getElementById(tabId).classList.add('active');
          
          // Update tab button styling
          tabBtns.forEach(b => b.classList.remove('border-blue-500', 'text-blue-600', 'active'));
          document.querySelector(`.tab-btn[data-tab="${tabId}"]`).classList.add('border-blue-500', 'text-blue-600', 'active');
          
          // Close sidebar on mobile
          if (window.innerWidth < 768) {
            sidebar.classList.remove('active');
            sidebarOverlay.classList.remove('active');
          }
        });
      });

document.addEventListener('DOMContentLoaded', function () {
  const settingsModal = document.getElementById('settingsModal');
  const closeSettings = document.getElementById('closeSettings');
  const cancelSettings = document.getElementById('cancelSettings');
  const saveSettings = document.getElementById('saveSettings');

  function closeSettingsModal() {
    settingsModal.classList.add('hidden');
  }

  function saveSettingsModal() {
    const showLabels = document.getElementById('nodeLabels').checked;
    const showArrows = document.getElementById('edgeArrows').checked;
    const communityColors = document.getElementById('communityColors').checked;

    if (typeof cy !== 'undefined' && cy) {
      cy.style()
        .selector('node')
        .style('label', showLabels ? 'data(label)' : '')
        .update();

      cy.style()
        .selector('edge')
        .style('target-arrow-shape', showArrows ? 'triangle' : 'none')
        .update();

      if (communityColors) {
        cy.nodes().forEach(node => {
          const communityId = node.data('community') || 0;
          node.style('background-color', colorMap[communityId % colorMap.length]);
        });
      } else {
        cy.nodes().style('background-color', '#3498db');
      }
    }

    showNotification('Settings saved successfully!', 'success');
    closeSettingsModal();
  }

  // üí° These must be outside of any other event listeners
  document.getElementById('profileMenuItemSettings').addEventListener('click', () => {
    settingsModal.classList.remove('hidden');
  });

  closeSettings.addEventListener('click', closeSettingsModal);
  cancelSettings.addEventListener('click', closeSettingsModal);
  saveSettings.addEventListener('click', saveSettingsModal);

  settingsModal.addEventListener('click', function (e) {
    if (e.target === settingsModal) {
      closeSettingsModal();
    }
  });
});

      // Handle form submission
      const uploadForm = document.getElementById("uploadForm");

if (uploadForm) {
  uploadForm.addEventListener("submit", function (e) {
    e.preventDefault();

    const fileInput = document.getElementById("fileInput");
    const formData = new FormData();
    formData.append("file", fileInput.files[0]);

    document.getElementById("errorMsg").classList.add("hidden");
    document.getElementById("statusMsg").textContent = "";
    document.getElementById("loadingSpinner").classList.remove("hidden");

    fetch("http://localhost:5000/upload", {
      method: "POST",
      body: formData,
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error("Server error");
        }
        return response.json();
      })
      .then((data) => {
  document.getElementById("loadingSpinner").classList.add("hidden");
  document.getElementById("statusMsg").textContent = "Analysis complete!";

  // üî• Set currentAnalysis before using it
  currentAnalysis = data;

  document.getElementById("nodeCount").textContent = data.metrics.nodes;
  document.getElementById("edgeCount").textContent = data.metrics.edges;
  document.getElementById("density").textContent = data.metrics.density.toFixed(4);
  document.getElementById("communityCount").textContent = [...new Set(Object.values(data.communities))].length;

  document.getElementById("densityMetric").textContent = data.metrics.density.toFixed(4);
  document.getElementById("pathLengthMetric").textContent = data.metrics.avg_path_length.toFixed(2);
  document.getElementById("modularityMetric").textContent = data.metrics.modularity.toFixed(2);

  document.getElementById("globalNodes").textContent = data.metrics.nodes;
  document.getElementById("globalEdges").textContent = data.metrics.edges;
  document.getElementById("avgDegree").textContent = data.metrics.avg_degree.toFixed(2);
  document.getElementById("diameter").textContent = data.metrics.diameter;

  document.getElementById("centralNode").textContent = data.most_central;
  document.getElementById("betweennessNode").textContent = data.highest_betweenness;
  document.getElementById("closenessNode").textContent = data.highest_closeness;

  drawGraph(data);
  drawChart(data.degree_centrality);
  renderTopNodesTable(data.top_nodes);
  renderPredictionTable(data.predictions);
  renderCommunities(data.communities);
  populateNodeSelector(data.nodes);

  document.getElementById("predictLinksBtn").classList.remove("hidden");

  // ‚úÖ Save to localStorage now that currentAnalysis is set
  saveToHistory(data);
})
      .catch((err) => {
        document.getElementById("loadingSpinner").classList.add("hidden");
        document.getElementById("errorMsg").textContent = "Error: " + err.message;
        document.getElementById("errorMsg").classList.remove("hidden");
      });
  });
}

          // Show loading spinner
          document.getElementById('loadingSpinner').classList.remove('hidden');
          document.getElementById('statusMsg').textContent = 'Processing your network data...';
          document.getElementById('errorMsg').classList.add('hidden');
          
          const fileInput = document.getElementById('fileInput');
          const formData = new FormData();
          formData.append('file', fileInput.files[0]);
          
          try {
            // In a real app, you would send this to a backend
            // For this demo, we'll simulate processing
            setTimeout(() => {
              // Simulated data
              const sampleData = {
                nodes: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'],
                edges: [
                  ['A', 'B'], ['A', 'C'], ['B', 'D'], ['C', 'D'], ['D', 'E'],
                  ['E', 'F'], ['F', 'G'], ['G', 'H'], ['H', 'I'], ['I', 'J'],
                  ['A', 'F'], ['B', 'G'], ['C', 'H'], ['D', 'I'], ['E', 'J']
                ],
                degree_centrality: {
                  'A': 0.444, 'B': 0.333, 'C': 0.333, 'D': 0.444, 'E': 0.333,
                  'F': 0.333, 'G': 0.333, 'H': 0.333, 'I': 0.333, 'J': 0.222
                },
                communities: {
                  'A': 1, 'B': 1, 'C': 1, 'D': 1, 'E': 2,
                  'F': 2, 'G': 2, 'H': 2, 'I': 2, 'J': 2
                },
                predictions: [
                  {source: 'A', target: 'E', probability: 85.2},
                  {source: 'B', target: 'F', probability: 78.6},
                  {source: 'C', target: 'G', probability: 72.3},
                  {source: 'D', target: 'H', probability: 68.9},
                  {source: 'A', target: 'J', probability: 65.4}
                ],
                metrics: {
                  nodes: 10,
                  edges: 15,
                  density: 0.333,
                  avg_degree: 3.0,
                  diameter: 4,
                  avg_path_length: 2.4,
                  modularity: 0.45
                },
                community_count: 2,
                top_nodes: [
                  {node: 'A', degree: 0.444, betweenness: 0.35, closeness: 0.55, eigenvector: 0.42},
                  {node: 'D', degree: 0.444, betweenness: 0.32, closeness: 0.52, eigenvector: 0.40},
                  {node: 'B', degree: 0.333, betweenness: 0.25, closeness: 0.48, eigenvector: 0.35},
                  {node: 'C', degree: 0.333, betweenness: 0.24, closeness: 0.47, eigenvector: 0.34},
                  {node: 'E', degree: 0.333, betweenness: 0.28, closeness: 0.50, eigenvector: 0.38}
                ],
                most_central: 'A (0.444)',
                highest_betweenness: 'A (0.35)',
                highest_closeness: 'A (0.55)'
              };
              
              // Store the current analysis
              currentAnalysis = sampleData;
              
              // Hide spinner
              document.getElementById('loadingSpinner').classList.add('hidden');
              document.getElementById('statusMsg').textContent = 'Analysis complete! Network visualized.';
              
              // Update metrics
              document.getElementById('nodeCount').textContent = sampleData.metrics.nodes;
              document.getElementById('edgeCount').textContent = sampleData.metrics.edges;
              document.getElementById('density').textContent = sampleData.metrics.density.toFixed(4);
              document.getElementById('communityCount').textContent = sampleData.community_count;
              
              // Update overview metrics
              document.getElementById('densityMetric').textContent = sampleData.metrics.density.toFixed(4);
              document.getElementById('pathLengthMetric').textContent = sampleData.metrics.avg_path_length.toFixed(2);
              document.getElementById('modularityMetric').textContent = sampleData.metrics.modularity.toFixed(2);
              
              // Update metrics tab
              document.getElementById('globalNodes').textContent = sampleData.metrics.nodes;
              document.getElementById('globalEdges').textContent = sampleData.metrics.edges;
              document.getElementById('avgDegree').textContent = sampleData.metrics.avg_degree.toFixed(2);
              document.getElementById('diameter').textContent = sampleData.metrics.diameter;
              
              // Update centrality nodes
              document.getElementById('centralNode').textContent = sampleData.most_central;
              document.getElementById('betweennessNode').textContent = sampleData.highest_betweenness;
              document.getElementById('closenessNode').textContent = sampleData.highest_closeness;
              
              // Render top nodes table
              renderTopNodesTable(sampleData.top_nodes || []);
              
              // Render communities
              renderCommunities(sampleData.communities || {});
              
              // Render predictions table
              renderPredictionTable(sampleData.predictions || []);
              
              // Draw centrality chart
              drawChart(sampleData.degree_centrality || {});
              
              // Draw graph
              drawGraph(sampleData);
              
              // Populate node selector
              populateNodeSelector(sampleData.nodes);
              
              // Enable prediction button
              document.getElementById('predictLinksBtn').classList.remove('hidden');
              
              showNotification('Network analysis completed successfully!', 'success');
            }, 2000);
            
          } catch (error) {
            document.getElementById('loadingSpinner').classList.add('hidden');
            document.getElementById('errorMsg').textContent = `Error: ${error.message}`;
            document.getElementById('errorMsg').classList.remove('hidden');
            showNotification('Failed to analyze network: ' + error.message, 'error');
          }
        });
       '}'
      
      // Sample data button
      document.getElementById('sampleDataBtn').addEventListener('click', async function() {
        document.getElementById('statusMsg').textContent = 'Loading sample social network data...';
        document.getElementById('loadingSpinner').classList.remove('hidden');
        
        try {
          // Create sample dataset
          const sampleData = {
            nodes: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J'],
            edges: [
              ['A', 'B'], ['A', 'C'], ['B', 'D'], ['C', 'D'], ['D', 'E'],
              ['E', 'F'], ['F', 'G'], ['G', 'H'], ['H', 'I'], ['I', 'J'],
              ['A', 'F'], ['B', 'G'], ['C', 'H'], ['D', 'I'], ['E', 'J']
            ],
            degree_centrality: {
              'A': 0.444, 'B': 0.333, 'C': 0.333, 'D': 0.444, 'E': 0.333,
              'F': 0.333, 'G': 0.333, 'H': 0.333, 'I': 0.333, 'J': 0.222
            },
            communities: {
              'A': 1, 'B': 1, 'C': 1, 'D': 1, 'E': 2,
              'F': 2, 'G': 2, 'H': 2, 'I': 2, 'J': 2
            },
            predictions: [
              {source: 'A', target: 'E', probability: 85.2},
              {source: 'B', target: 'F', probability: 78.6},
              {source: 'C', target: 'G', probability: 72.3},
              {source: 'D', target: 'H', probability: 68.9},
              {source: 'A', target: 'J', probability: 65.4}
            ],
            metrics: {
              nodes: 10,
              edges: 15,
              density: 0.333,
              avg_degree: 3.0,
              diameter: 4,
              avg_path_length: 2.4,
              modularity: 0.45
            },
            community_count: 2,
            top_nodes: [
              {node: 'A', degree: 0.444, betweenness: 0.35, closeness: 0.55, eigenvector: 0.42},
              {node: 'D', degree: 0.444, betweenness: 0.32, closeness: 0.52, eigenvector: 0.40},
              {node: 'B', degree: 0.333, betweenness: 0.25, closeness: 0.48, eigenvector: 0.35},
              {node: 'C', degree: 0.333, betweenness: 0.24, closeness: 0.47, eigenvector: 0.34},
              {node: 'E', degree: 0.333, betweenness: 0.28, closeness: 0.50, eigenvector: 0.38}
            ],
            most_central: 'A (0.444)',
            highest_betweenness: 'A (0.35)',
            highest_closeness: 'A (0.55)'
          };
          
          // Store the current analysis
          currentAnalysis = sampleData;
          
          setTimeout(() => {
            document.getElementById('loadingSpinner').classList.add('hidden');
            document.getElementById('statusMsg').textContent = 'Sample data loaded successfully!';
            
            // Update metrics
            document.getElementById('nodeCount').textContent = sampleData.metrics.nodes;
            document.getElementById('edgeCount').textContent = sampleData.metrics.edges;
            document.getElementById('density').textContent = sampleData.metrics.density.toFixed(4);
            document.getElementById('communityCount').textContent = sampleData.community_count;
            
            // Update overview metrics
            document.getElementById('densityMetric').textContent = sampleData.metrics.density.toFixed(4);
            document.getElementById('pathLengthMetric').textContent = sampleData.metrics.avg_path_length.toFixed(2);
            document.getElementById('modularityMetric').textContent = sampleData.metrics.modularity.toFixed(2);
            
            // Update metrics tab
            document.getElementById('globalNodes').textContent = sampleData.metrics.nodes;
            document.getElementById('globalEdges').textContent = sampleData.metrics.edges;
            document.getElementById('avgDegree').textContent = sampleData.metrics.avg_degree.toFixed(2);
            document.getElementById('diameter').textContent = sampleData.metrics.diameter;
            
            // Update centrality nodes
            document.getElementById('centralNode').textContent = sampleData.most_central;
            document.getElementById('betweennessNode').textContent = sampleData.highest_betweenness;
            document.getElementById('closenessNode').textContent = sampleData.highest_closeness;
            
            // Render top nodes table
            renderTopNodesTable(sampleData.top_nodes || []);
            
            // Render communities
            renderCommunities(sampleData.communities || {});
            
            // Render predictions table
            renderPredictionTable(sampleData.predictions || []);
            
            // Draw centrality chart
            drawChart(sampleData.degree_centrality || {});
            
            // Draw graph
            drawGraph(sampleData);
            
            // Populate node selector
            populateNodeSelector(sampleData.nodes);
            
            // Enable prediction button
            document.getElementById('predictLinksBtn').classList.remove('hidden');

            saveToHistory(currentAnalysis);
            
            showNotification('Sample data loaded successfully!', 'success');
          }, 1500);
        } catch (error) {
          document.getElementById('loadingSpinner').classList.add('hidden');
          document.getElementById('errorMsg').textContent = `Error: ${error.message}`;
          document.getElementById('errorMsg').classList.remove('hidden');
          showNotification('Failed to load sample data: ' + error.message, 'error');
        }
      });
      
      // Link prediction button
      document.getElementById('predictLinksBtn').addEventListener('click', function() {
        document.getElementById('statusMsg').textContent = 'Predicting potential links...';
        document.getElementById('loadingSpinner').classList.remove('hidden');
        
        setTimeout(() => {
          document.getElementById('loadingSpinner').classList.add('hidden');
          document.getElementById('statusMsg').textContent = 'Link prediction complete! Potential links identified.';
          
          // Switch to predictions tab
          document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('border-blue-500', 'text-blue-600'));
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          
          const predictionsTabBtn = document.querySelector('.tab-btn[data-tab="predictionsTab"]');
          predictionsTabBtn.classList.add('border-blue-500', 'text-blue-600');
          document.getElementById('predictionsTab').classList.add('active');
          
          showNotification('Link prediction completed successfully!', 'success');
        }, 2000);
      });
      
      // Node selector
      document.getElementById('nodeSelector').addEventListener('change', function() {
        const nodeId = this.value;
        if (!nodeId) return;
        
        // In a real app, you would fetch detailed node analysis
        const nodeAnalysis = {
          id: nodeId,
          centrality: currentAnalysis.degree_centrality[nodeId] || 0,
          community: currentAnalysis.communities[nodeId] || 0,
          neighbors: ['B', 'C', 'F'] // Sample data
        };
        
        renderNodeAnalysis(nodeAnalysis);
      });
      
      // Export handlers
      document.getElementById('exportCSV').addEventListener('click', function() {
        if (currentAnalysis) {
          exportCSV();
          showNotification('CSV exported successfully!', 'success');
        } else {
          showNotification('No data to export', 'error');
        }
      });
      
      document.getElementById('exportPNG').addEventListener('click', function() {
        if (cy) {
          const png = cy.png({ full: true, scale: 2 });
          const link = document.createElement('a');
          link.href = png;
          link.download = 'network_graph.png';
          link.click();
          showNotification('Graph image exported!', 'success');
        } else {
          showNotification('No graph to export', 'error');
        }
      });
      
      document.getElementById('exportPDF').addEventListener('click', function() {
        if (currentAnalysis) {
          exportPDF();
          showNotification('PDF report exported!', 'success');
        } else {
          showNotification('No data to export', 'error');
        }
      });
      
      document.getElementById('customExport').addEventListener('click', function() {
        if (currentAnalysis) {
          const format = document.getElementById('exportFormat').value;
          const content = document.getElementById('exportContent').value;
          
          if (format === 'CSV') {
            exportCSV(content);
          } else if (format === 'JSON') {
            exportJSON(content);
          } else {
            exportExcel(content);
          }
          
          showNotification(`${content} exported as ${format}`, 'success');
        } else {
          showNotification('No data to export', 'error');
        }
      });
      
      // Download button in header
      document.getElementById('downloadBtn').addEventListener('click', function() {

        document.querySelectorAll(".tab-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
    document.querySelectorAll(".tab-content").forEach(tab => tab.classList.add("hidden"));

    btn.classList.add("active");

    const tabId = btn.textContent.trim().toLowerCase().replace(/ /g, "") + "Tab";
    const targetTab = document.getElementById(tabId);
    if (targetTab) {
      targetTab.classList.remove("hidden");
      if (tabId === "historicaldataTab") {
        renderHistoryList();
      }
    }
  });
});

        // Switch to export tab
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('border-blue-500', 'text-blue-600'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        const exportTabBtn = document.querySelector('.tab-btn[data-tab="exportTab"]');
        exportTabBtn.classList.add('border-blue-500', 'text-blue-600');
        document.getElementById('exportTab').classList.add('active');
      });
    '}';

    // Function to load sample data for use cases
    function loadSample(type) {
      document.getElementById('statusMsg').textContent = `Loading ${type} sample data...`;
      document.getElementById('loadingSpinner').classList.remove('hidden');

      // Define sample datasets for each use case
      const sampleDatasets = {
        health: {
          nodes: ['John', 'Mary', 'Ali', 'Sameer', 'Emma', 'Liam', 'Noah', 'Olivia', 'Ava', 'Isabella'],
          edges: [
            ['John', 'Mary'], ['Mary', 'Ali'], ['Ali', 'Sameer'], ['John', 'Sameer'],
            ['Sameer', 'Emma'], ['Emma', 'Liam'], ['Liam', 'Noah'], ['Noah', 'Olivia'],
            ['Olivia', 'Ava'], ['Ava', 'Isabella'], ['John', 'Liam'], ['Mary', 'Noah'],
            ['Ali', 'Olivia'], ['Sameer', 'Ava'], ['Emma', 'Isabella']
          ],
          degree_centrality: {
            'John': 0.444, 'Mary': 0.333, 'Ali': 0.333, 'Sameer': 0.444, 'Emma': 0.333,
            'Liam': 0.333, 'Noah': 0.333, 'Olivia': 0.333, 'Ava': 0.333, 'Isabella': 0.222
          },
          communities: {
            'John': 1, 'Mary': 1, 'Ali': 1, 'Sameer': 1, 'Emma': 2,
            'Liam': 2, 'Noah': 2, 'Olivia': 2, 'Ava': 2, 'Isabella': 2
          },
          predictions: [
            {source: 'John', target: 'Emma', probability: 85.2},
            {source: 'Mary', target: 'Liam', probability: 78.6},
            {source: 'Ali', target: 'Noah', probability: 72.3},
            {source: 'Sameer', target: 'Olivia', probability: 68.9},
            {source: 'John', target: 'Isabella', probability: 65.4}
          ],
          metrics: {
            nodes: 10,
            edges: 15,
            density: 0.333,
            avg_degree: 3.0,
            diameter: 4,
            avg_path_length: 2.4,
            modularity: 0.45
          },
          community_count: 2,
          top_nodes: [
            {node: 'John', degree: 0.444, betweenness: 0.35, closeness: 0.55, eigenvector: 0.42},
            {node: 'Sameer', degree: 0.444, betweenness: 0.32, closeness: 0.52, eigenvector: 0.40},
            {node: 'Mary', degree: 0.333, betweenness: 0.25, closeness: 0.48, eigenvector: 0.35},
            {node: 'Ali', degree: 0.333, betweenness: 0.24, closeness: 0.47, eigenvector: 0.34},
            {node: 'Emma', degree: 0.333, betweenness: 0.28, closeness: 0.50, eigenvector: 0.38}
          ],
          most_central: 'John (0.444)',
          highest_betweenness: 'John (0.35)',
          highest_closeness: 'John (0.55)'
        },
        hr: {
          nodes: ['Alice', 'Bob', 'Charlie', 'David', 'Eve', 'Frank', 'Grace', 'Heidi', 'Ivan', 'Judy'],
          edges: [
            ['Alice', 'Bob'], ['Alice', 'David'], ['Bob', 'Eve'], ['Eve', 'Charlie'],
            ['Charlie', 'Frank'], ['Frank', 'Grace'], ['Grace', 'Heidi'], ['Heidi', 'Ivan'],
            ['Ivan', 'Judy'], ['Alice', 'Grace'], ['Bob', 'Heidi'], ['Charlie', 'Ivan'],
            ['David', 'Judy'], ['Eve', 'Alice']
          ],
          // ... similar structure as above ...
        },
        cybersecurity: {
          nodes: ['192.168.0.1', '192.168.0.2', '10.0.0.5', '10.0.0.9', '172.16.0.3', 
                  '172.16.0.4', '192.168.1.1', '10.1.1.1', '172.17.0.5', '192.168.2.1'],
          edges: [
            ['192.168.0.1', '192.168.0.2'], ['192.168.0.2', '10.0.0.5'], 
            ['10.0.0.5', '10.0.0.9'], ['192.168.0.1', '10.0.0.9'],
            ['10.0.0.9', '172.16.0.3'], ['172.16.0.3', '172.16.0.4'],
            ['172.16.0.4', '192.168.1.1'], ['192.168.1.1', '10.1.1.1'],
            ['10.1.1.1', '172.17.0.5'], ['172.17.0.5', '192.168.2.1']
          ],
          // ... similar structure as above ...
        },
        social: {
          nodes: ['@elonmusk', '@tesla', '@spacex', '@nasa', '@isro', 
                  '@billgates', '@microsoft', '@github', '@openai', '@googleai'],
          edges: [
            ['@elonmusk', '@tesla'], ['@tesla', '@spacex'], ['@spacex', '@nasa'], 
            ['@nasa', '@isro'], ['@elonmusk', '@spacex'], ['@billgates', '@microsoft'],
            ['@microsoft', '@github'], ['@github', '@openai'], ['@openai', '@googleai'],
            ['@elonmusk', '@billgates'], ['@tesla', '@openai']
          ],
          // ... similar structure as above ...
        },
        academic: {
          nodes: ['Paper1', 'Paper2', 'Paper3', 'Paper4', 'Paper5', 
                  'Paper6', 'Paper7', 'Paper8', 'Paper9', 'Paper10'],
          edges: [
            ['Paper1', 'Paper2'], ['Paper2', 'Paper3'], ['Paper3', 'Paper4'], 
            ['Paper4', 'Paper5'], ['Paper1', 'Paper5'], ['Paper6', 'Paper7'],
            ['Paper7', 'Paper8'], ['Paper8', 'Paper9'], ['Paper9', 'Paper10'],
            ['Paper5', 'Paper6'], ['Paper3', 'Paper8'], ['Paper1', 'Paper10']
          ],
          // ... similar structure as above ...
        },
        ecommerce: {
          nodes: ['Customer1', 'Customer2', 'Customer3', 'Customer4', 'Customer5', 
                  'ProductA', 'ProductB', 'ProductC', 'ProductD', 'ProductE'],
          edges: [
            ['Customer1', 'ProductA'], ['Customer1', 'ProductB'], ['Customer2', 'ProductA'],
            ['Customer2', 'ProductC'], ['Customer3', 'ProductB'], ['Customer3', 'ProductD'],
            ['Customer4', 'ProductC'], ['Customer4', 'ProductE'], ['Customer5', 'ProductD'],
            ['Customer5', 'ProductE'], ['Customer1', 'Customer2'], ['Customer3', 'Customer4']
          ],
          // ... similar structure as above ...
        }
      };
      
      setTimeout(() => {
        if (sampleDatasets[type]) {
          const sampleData = sampleDatasets[type];
          currentAnalysis = sampleData;
          
          document.getElementById('loadingSpinner').classList.add('hidden');
          document.getElementById('statusMsg').textContent = `${type} sample data loaded!`;
          
          // Update metrics
          document.getElementById('nodeCount').textContent = sampleData.metrics.nodes;
          document.getElementById('edgeCount').textContent = sampleData.metrics.edges;
          document.getElementById('density').textContent = sampleData.metrics.density.toFixed(4);
          document.getElementById('communityCount').textContent = sampleData.community_count;
          
          document.getElementById('densityMetric').textContent = sampleData.metrics.density.toFixed(4);
          document.getElementById('pathLengthMetric').textContent = sampleData.metrics.avg_path_length.toFixed(2);
          document.getElementById('modularityMetric').textContent = sampleData.metrics.modularity.toFixed(2);
          
          document.getElementById('globalNodes').textContent = sampleData.metrics.nodes;
          document.getElementById('globalEdges').textContent = sampleData.metrics.edges;
          document.getElementById('avgDegree').textContent = sampleData.metrics.avg_degree.toFixed(2);
          document.getElementById('diameter').textContent = sampleData.metrics.diameter;
          
          document.getElementById('centralNode').textContent = sampleData.most_central;
          document.getElementById('betweennessNode').textContent = sampleData.highest_betweenness;
          document.getElementById('closenessNode').textContent = sampleData.highest_closeness;
          
          renderTopNodesTable(sampleData.top_nodes || []);
          renderCommunities(sampleData.communities || {});
          renderPredictionTable(sampleData.predictions || []);
          drawChart(sampleData.degree_centrality || {});
          drawGraph(sampleData);
          populateNodeSelector(sampleData.nodes);
          
          document.getElementById('predictLinksBtn').classList.remove('hidden');
          
          showNotification(`${type} sample data loaded successfully!`, 'success');
        } else {
          document.getElementById('loadingSpinner').classList.add('hidden');
          document.getElementById('errorMsg').textContent = `Error: Sample type "${type}" not found`;
          document.getElementById('errorMsg').classList.remove('hidden');
          showNotification(`Failed to load sample data: type "${type}" not found`, 'error');
        }
      }, 1500);
    }

    function saveToHistory(analysisData) {
  const history = JSON.parse(localStorage.getItem("networkHistory")) || [];
  const entry = {
    id: Date.now(),
    timestamp: new Date().toLocaleString(),
    summary: {
      nodes: analysisData.metrics.nodes,
      edges: analysisData.metrics.edges,
      density: analysisData.metrics.density.toFixed(4),
    },
    data: analysisData
  };
  history.unshift(entry); // add to top
  localStorage.setItem("networkHistory", JSON.stringify(history));
}

    function renderHistoryList() {
  const history = JSON.parse(localStorage.getItem("networkHistory")) || [];
  const list = document.getElementById("historyList");
  list.innerHTML = "";

  if (history.length === 0) {
    list.innerHTML = "<p class='text-gray-500'>No past analysis found.</p>";
    return;
  }

  history.forEach(entry => {
    const card = document.createElement("div");
    card.className = "bg-white rounded shadow p-4 cursor-pointer hover:bg-blue-50 transition";
    card.innerHTML = `
      <div class="font-semibold mb-1">Analyzed on: ${entry.timestamp}</div>
      <div class="text-sm text-gray-600">Nodes: ${entry.summary.nodes}, Edges: ${entry.summary.edges}, Density: ${entry.summary.density}</div>
    `;
    card.onclick = () => {
      drawGraph(entry.data);
      drawChart(entry.data.degree_centrality);
      renderTopNodesTable(entry.data.top_nodes);
      renderPredictionTable(entry.data.predictions);
      renderCommunities(entry.data.communities);
      populateNodeSelector(entry.data.nodes);
      document.getElementById("predictLinksBtn").classList.remove("hidden");
    };
    list.appendChild(card);
  });
}
    
    // Function to populate node selector
    function populateNodeSelector(nodes) {
      const selector = document.getElementById('nodeSelector');
      selector.innerHTML = '<option value="">Select a node</option>';
      
      nodes.forEach(node => {
        const option = document.createElement('option');
        option.value = node;
        option.textContent = node;
        selector.appendChild(option);
      });
    }
    
    // Function to render node analysis
    function renderNodeAnalysis(node) {
      const container = document.getElementById('nodeAnalysisResults');
      container.innerHTML = `
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="border rounded-lg p-4">
            <h3 class="font-bold mb-3">Basic Info</h3>
            <div class="space-y-2">
              <div class="flex justify-between">
                <span>Node ID:</span>
                <span class="font-mono">${node.id}</span>
              </div>
              <div class="flex justify-between">
                <span>Community:</span>
                <span class="font-mono">${node.community + 1}</span>
              </div>
              <div class="flex justify-between">
                <span>Degree Centrality:</span>
                <span class="font-mono">${node.centrality.toFixed(3)}</span>
              </div>
            </div>
          </div>
          <div class="border rounded-lg p-4">
            <h3 class="font-bold mb-3">Connections</h3>
            <div class="space-y-2">
              <div class="flex justify-between">
                <span>Number of Neighbors:</span>
                <span class="font-mono">${node.neighbors.length}</span>
              </div>
              <div>
                <span>Connected Nodes:</span>
                <div class="flex flex-wrap gap-1 mt-2">
                  ${node.neighbors.map(n => `<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">${n}</span>`).join('')}
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="mt-4">
          <h3 class="font-bold mb-3">Centrality Comparison</h3>
          <div class="h-48">
            <canvas id="nodeCentralityChart"></canvas>
          </div>
        </div>
      `;
      
      // Draw centrality comparison chart
      const ctx = document.getElementById('nodeCentralityChart').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Degree', 'Betweenness', 'Closeness', 'Eigenvector'],
          datasets: [{
            label: 'Centrality Score',
            data: [0.45, 0.32, 0.38, 0.41],
            backgroundColor: 'rgba(54, 162, 235, 0.6)',
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              max: 1
            }
          }
        }
      });
    }
    
    // Function to render top nodes table
    function renderTopNodesTable(topNodes) {
      const tbody = document.getElementById('topNodesTable');
      tbody.innerHTML = '';
      
      if (topNodes.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" class="text-center py-4">No data available</td></tr>';
        return;
      }
      
      topNodes.forEach(node => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap">${node.node}</td>
          <td class="px-6 py-4 whitespace-nowrap">${node.degree.toFixed(3)}</td>
          <td class="px-6 py-4 whitespace-nowrap">${node.betweenness.toFixed(3)}</td>
          <td class="px-6 py-4 whitespace-nowrap">${node.closeness.toFixed(3)}</td>
          <td class="px-6 py-4 whitespace-nowrap">${node.eigenvector.toFixed(3)}</td>
        `;
        tbody.appendChild(row);
      });
    }
    
    // Function to render communities
    function renderCommunities(communities) {
      const container = document.getElementById('communitiesList');
      container.innerHTML = '';
      
      if (Object.keys(communities).length === 0) {
        container.innerHTML = '<div class="text-center py-8 text-gray-500"><i class="fas fa-layer-group text-4xl mb-3"></i><p>No community data available</p></div>';
        return;
      }
      
      // Group nodes by community
      const communitiesMap = {};
      for (const [node, communityId] of Object.entries(communities)) {
        if (!communitiesMap[communityId]) {
          communitiesMap[communityId] = [];
        }
        communitiesMap[communityId].push(node);
      }
      
      // Create community cards
      for (const [communityId, nodes] of Object.entries(communitiesMap)) {
        const card = document.createElement('div');
        card.className = 'border rounded-lg p-4';
        card.innerHTML = `
          <div class="flex items-center mb-3">
            <div class="w-6 h-6 rounded-full mr-2" style="background-color: ${colorMap[communityId % colorMap.length]}"></div>
            <h3 class="font-bold">Community ${parseInt(communityId) + 1}</h3>
            <span class="ml-auto bg-gray-100 text-gray-800 text-xs font-medium px-2 py-1 rounded-full">
              ${nodes.length} nodes
            </span>
          </div>
          <div class="text-sm text-gray-600 flex flex-wrap gap-1">
            ${nodes.slice(0, 10).map(node => `<span class="bg-gray-100 px-2 py-1 rounded">${node}</span>`).join('')}
            ${nodes.length > 10 ? `<span class="bg-gray-100 px-2 py-1 rounded">+${nodes.length - 10} more</span>` : ''}
          </div>
        `;
        container.appendChild(card);
      }
    }
    
    // Function to render prediction table
    function renderPredictionTable(predictions) {
      const tbody = document.getElementById('predictionTable');
      tbody.innerHTML = '';
      
      if (predictions.length === 0) {
        tbody.innerHTML = '<tr><td colspan="3" class="text-center py-4">No predictions available</td></tr>';
        return;
      }
      
      predictions.forEach(pred => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="px-6 py-4 whitespace-nowrap">${pred.source}</td>
          <td class="px-6 py-4 whitespace-nowrap">${pred.target}</td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="w-full bg-gray-200 rounded-full h-2.5">
              <div class="bg-blue-600 h-2.5 rounded-full" style="width: ${pred.probability}%"></div>
            </div>
            <span class="text-sm">${pred.probability}%</span>
          </td>
        `;
        tbody.appendChild(row);
      });
    }
    
    // Function to draw centrality chart
    function drawChart(centrality) {
  const ctx = document.getElementById('centralityChart').getContext('2d');

  // Destroy previous chart if exists
  if (centralityChart) {
    centralityChart.destroy();
  }

  const labels = Object.keys(centrality);
  const values = Object.values(centrality);

  centralityChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [{
        label: 'Degree Centrality',
        data: values,
        backgroundColor: 'rgba(54, 162, 235, 0.6)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            label: function(context) {
              return `Centrality: ${context.parsed.y.toFixed(3)}`;
            }
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          title: {
            display: true,
            text: 'Centrality Score'
          }
        },
        x: {
          title: {
            display: true,
            text: 'Nodes'
          }
        }
      }
    }
  });
}

    
    // Function to draw the graph
    function drawGraph(data) {
      const graphEl = document.getElementById('graph');
      graphEl.innerHTML = '';
      
      const elements = [];
      
      // Add nodes
      data.nodes.forEach(node => {
        const communityId = data.communities ? data.communities[node] || 0 : 0;
        const centrality = data.degree_centrality ? data.degree_centrality[node] || 0 : 0;
        
        elements.push({
          data: {
            id: node,
            label: node,
            community: communityId,
            centrality: centrality
          }
        });
      });
      
      // Add edges
      data.edges.forEach(edge => {
        elements.push({
          data: {
            id: `${edge[0]}-${edge[1]}`,
            source: edge[0],
            target: edge[1]
          }
        });
      });
      
      // Initialize Cytoscape

      cy = cytoscape({
        container: graphEl,
        elements: elements,
        style: [
          {
            selector: 'node',
            style: {
              'background-color': ele => {
                const communityId = ele.data('community') || 0;
                return colorMap[communityId % colorMap.length];
              },
              'label': 'data(label)',
              'width': ele => 20 + (ele.data('centrality') || 0) * 50,
              'height': ele => 20 + (ele.data('centrality') || 0) * 50,
              'color': '#fff',
              'font-size': '10px',
              'text-valign': 'center',
              'text-halign': 'center',
              'text-outline-color': '#000',
              'text-outline-width': '1px'
            }
          },
          {
            selector: 'edge',
            style: {
              'width': 2,
              'line-color': '#aaa',
              'target-arrow-shape': 'triangle',
              'target-arrow-color': '#aaa',
              'curve-style': 'bezier'
            }
          }
        ],
        layout: {
          name: 'cose',
          idealEdgeLength: 100,
          nodeOverlap: 20,
          refresh: 20,
          fit: true,
          padding: 30,
          randomize: false,
          componentSpacing: 100,
          nodeRepulsion: 400000,
          edgeElasticity: 100,
          nestingFactor: 5,
          gravity: 80,
          numIter: 1000,
          initialTemp: 200,
          coolingFactor: 0.95,
          minTemp: 1.0
        }
      });
      
      // Node click handler
      cy.on('tap', 'node', function(evt) {
        const node = evt.target;
        const nodeInfo = document.getElementById('nodeInfo');
        const nodeDetails = document.getElementById('nodeDetails');
        
        nodeDetails.innerHTML = `
          <p><strong>ID:</strong> ${node.id()}</p>
          <p><strong>Community:</strong> ${node.data('community') + 1}</p>
          <p><strong>Centrality:</strong> ${(node.data('centrality') || 0).toFixed(3)}</p>
          <p><strong>Degree:</strong> ${node.degree()}</p>
          <p><strong>Neighbors:</strong> ${node.neighborhood().map(n => n.id()).join(', ')}</p>
        `;
        
        nodeInfo.style.display = 'block';
      });
      
      // Click outside node to hide info
      cy.on('tap', function(evt) {
        if (evt.target === cy) {
          document.getElementById('nodeInfo').style.display = 'none';
        }
      });
      
      // Search functionality
      const searchInput = document.getElementById('searchNode');
      searchInput.addEventListener('input', function() {
        const query = this.value.trim().toLowerCase();
        if (!query) return;
        
        const node = cy.getElementById(query);
        if (node) {
          cy.animate({
            center: { eles: node },
            zoom: 1.5,
            duration: 1000
          });
          
          node.animate({
            style: {
              'border-width': '3px',
              'border-color': '#ff0000'
            }
          }, {
            duration: 1000,
            complete: function() {
              node.style('border-width', '0px');
            }
          });
        }
      });
    }
    
    // Function to export CSV
    function exportCSV(contentType = 'All Metrics') {
      if (!currentAnalysis) return;
      
      let csvContent = "data:text/csv;charset=utf-8,";
      
      if (contentType === 'All Metrics') {
        // Add global metrics
        csvContent += "Global Metrics\n";
        csvContent += `Nodes,${currentAnalysis.metrics.nodes}\n`;
        csvContent += `Edges,${currentAnalysis.metrics.edges}\n`;
        csvContent += `Density,${currentAnalysis.metrics.density}\n`;
        csvContent += `Avg Path Length,${currentAnalysis.metrics.avg_path_length}\n`;
        csvContent += `Modularity,${currentAnalysis.metrics.modularity}\n\n`;
        
        // Add centrality data
        csvContent += "Node Centrality\n";
        csvContent += "Node,Degree Centrality\n";
        Object.entries(currentAnalysis.degree_centrality).forEach(([node, centrality]) => {
          csvContent += `${node},${centrality}\n`;
        });
        
        csvContent += "\n";
        
        // Add predictions
        csvContent += "Link Predictions\n";
        csvContent += "Source,Target,Probability\n";
        currentAnalysis.predictions.forEach(pred => {
          csvContent += `${pred.source},${pred.target},${pred.probability}\n`;
        });
      } else if (contentType === 'Centrality Scores') {
        csvContent += "Node,Degree Centrality\n";
        Object.entries(currentAnalysis.degree_centrality).forEach(([node, centrality]) => {
          csvContent += `${node},${centrality}\n`;
        });
      } else if (contentType === 'Community Data') {
        csvContent += "Node,Community\n";
        Object.entries(currentAnalysis.communities).forEach(([node, community]) => {
          csvContent += `${node},${community}\n`;
        });
      } else if (contentType === 'Link Predictions') {
        csvContent += "Source,Target,Probability\n";
        currentAnalysis.predictions.forEach(pred => {
          csvContent += `${pred.source},${pred.target},${pred.probability}\n`;
        });
      }
      
      const encodedUri = encodeURI(csvContent);
      const link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "network_analysis.csv");
      document.body.appendChild(link);
      
      link.click();
      document.body.removeChild(link);
    }
    
    // Function to export JSON
    function exportJSON(contentType = 'All Metrics') {
      if (!currentAnalysis) return;
      
      let dataToExport;
      
      if (contentType === 'All Metrics') {
        dataToExport = currentAnalysis;
      } else if (contentType === 'Centrality Scores') {
        dataToExport = currentAnalysis.degree_centrality;
      } else if (contentType === 'Community Data') {
        dataToExport = currentAnalysis.communities;
      } else if (contentType === 'Link Predictions') {
        dataToExport = currentAnalysis.predictions;
      }
      
      const dataStr = JSON.stringify(dataToExport, null, 2);
      const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
      
      const link = document.createElement('a');
      link.setAttribute('href', dataUri);
      link.setAttribute('download', 'network_data.json');
      document.body.appendChild(link);
      
      link.click();
      document.body.removeChild(link);
    }
    
    // Function to export Excel (simulated)
    function exportExcel(contentType) {
      // In a real app, you would use a library like SheetJS
      showNotification(`Excel export for ${contentType} is not implemented in this demo`, 'info');
    }
    
    // Function to export PDF
    function exportPDF() {
      if (!currentAnalysis) return;
      
      // Create a temporary container for PDF content
      const pdfContainer = document.createElement('div');
      pdfContainer.style.position = 'absolute';
      pdfContainer.style.left = '-9999px';
      pdfContainer.style.width = '800px';
      pdfContainer.style.padding = '20px';
      pdfContainer.style.backgroundColor = 'white';
      
      // Add content to PDF container
      pdfContainer.innerHTML = `
        <h1 style="text-align: center; margin-bottom: 20px;">Network Analysis Report</h1>
        <h2>Summary Metrics</h2>
        <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
          <tr>
            <th style="border: 1px solid #ddd; padding: 8px;">Metric</th>
            <th style="border: 1px solid #ddd; padding: 8px;">Value</th>
          </tr>
          <tr>
            <td style="border: 1px solid #ddd; padding: 8px;">Nodes</td>
            <td style="border: 1px solid #ddd; padding: 8px;">${currentAnalysis.metrics.nodes}</td>
          </tr>
          <tr>
            <td style="border: 1px solid #ddd; padding: 8px;">Edges</td>
            <td style="border: 1px solid #ddd; padding: 8px;">${currentAnalysis.metrics.edges}</td>
          </tr>
          <tr>
            <td style="border: 1px solid #ddd; padding: 8px;">Density</td>
            <td style="border: 1px solid #ddd; padding: 8px;">${currentAnalysis.metrics.density.toFixed(4)}</td>
          </tr>
          <tr>
            <td style="border: 1px solid #ddd; padding: 8px;">Modularity</td>
            <td style="border: 1px solid #ddd; padding: 8px;">${currentAnalysis.metrics.modularity.toFixed(4)}</td>
          </tr>
        </table>
        
        <h2>Top Nodes</h2>
        <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
          <tr>
            <th style="border: 1px solid #ddd; padding: 8px;">Node</th>
            <th style="border: 1px solid #ddd; padding: 8px;">Degree</th>
            <th style="border: 1px solid #ddd; padding: 8px;">Betweenness</th>
            <th style="border: 1px solid #ddd; padding: 8px;">Closeness</th>
          </tr>
          ${currentAnalysis.top_nodes.slice(0, 5).map(node => `
            <tr>
              <td style="border: 1px solid #ddd; padding: 8px;">${node.node}</td>
              <td style="border: 1px solid #ddd; padding: 8px;">${node.degree.toFixed(3)}</td>
              <td style="border: 1px solid #ddd; padding: 8px;">${node.betweenness.toFixed(3)}</td>
              <td style="border: 1px solid #ddd; padding: 8px;">${node.closeness.toFixed(3)}</td>
            </tr>
          `).join('')}
        </table>
        
        <h2>Link Predictions</h2>
        <table style="width: 100%; border-collapse: collapse;">
          <tr>
            <th style="border: 1px solid #ddd; padding: 8px;">Source</th>
            <th style="border: 1px solid #ddd; padding: 8px;">Target</th>
            <th style="border: 1px solid #ddd; padding: 8px;">Probability</th>
          </tr>
          ${currentAnalysis.predictions.slice(0, 5).map(pred => `
            <tr>
              <td style="border: 1px solid #ddd; padding: 8px;">${pred.source}</td>
              <td style="border: 1px solid #ddd; padding: 8px;">${pred.target}</td>
              <td style="border: 1px solid #ddd; padding: 8px;">${pred.probability}%</td>
            </tr>
          `).join('')}
        </table>
      `;
      
      document.body.appendChild(pdfContainer);
      
      // Generate PDF
      html2canvas(pdfContainer).then(canvas => {
        const imgData = canvas.toDataURL('image/png');
        const pdf = new jspdf.jsPDF('p', 'mm', 'a4');
        const imgWidth = 210; // A4 width in mm
        const pageHeight = 297; // A4 height in mm
        const imgHeight = canvas.height * imgWidth / canvas.width;
        let heightLeft = imgHeight;
        let position = 0;
        
        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;
        
        // Add new pages if content is too long
        while (heightLeft >= 0) {
          position = heightLeft - imgHeight;
          pdf.addPage();
          pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
          heightLeft -= pageHeight;
        }
        
        pdf.save('network_analysis_report.pdf');
        document.body.removeChild(pdfContainer);
      });
    }

    // Function to show notifications
    function showNotification(message, type = 'info') {
      // Create notification element
      const notification = document.createElement('div');
      notification.className = `fixed top-4 right-4 px-4 py-3 rounded shadow-lg text-white ${
        type === 'success' ? 'bg-green-500' : 
        type === 'error' ? 'bg-red-500' : 'bg-blue-500'
      }`;
      notification.innerHTML = `
        <div class="flex items-center">
          <i class="fas ${
            type === 'success' ? 'fa-check-circle' : 
            type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'
          } mr-2"></i>
          <span>${message}</span>
        </div>
      `;

   
      
      // Add to document
      document.body.appendChild(notification);
      
      // Remove after delay
      setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 3000);
    }
  </script>
</body>
</html>